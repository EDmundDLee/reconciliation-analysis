!function(a){a.fn.extend({caslike:function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,q,r,s,t,u,v;if(b=a.extend(!0,{platId:"",siteId:"",docId:"",color:"",fontSize:"",readOnly:!1,displayObj:"",docIds:"",likeText:"点赞",unlikeText:"取消点赞",isCancel:!0,theme:""},b),c=a.trim(b.theme),"vote"==c?a("head").append("<link>").children(":last").attr({rel:"stylesheet",type:"text/css",href:"//api.cas.cn/app/like/css/caslike.vote.css"}):a("head").append("<link>").children(":last").attr({rel:"stylesheet",type:"text/css",href:"//api.cas.cn/app/like/css/caslike.css"}),d=a(this),e="//api2.cas.cn/app/click/checklike.json",f=a.trim(b.platId),g=a.trim(b.siteId),h=b.readOnly)i=a.trim(b.docIds),j=b.displayObj,a.ajax({type:"get",url:e,jsonp:"cascallback",jsonpCallback:"cas_call",dataType:"jsonp",timeout:3e3,data:"pid="+f+"&sid="+g+"&dids="+i,success:function(b){"200"==b.status&&a.each(b.data,function(a,b){j.eq(a).html(b.like_num)})}});else{if(k="//api2.cas.cn/app/click/like.json",l="//api2.cas.cn/app/click/unlike.json",m=a.trim(b.docId),n=a.trim(b.color),o=a.trim(b.fontSize),a.trim(b.pvName),q="",r="",s=a.trim(b.likeText),t=a.trim(b.unlikeText),u=b.isCancel,""!=o&&(r='style="font-size:'+o+';"',q='style="font-size:'+o+";"),""!=n?""!=q?q+=" color:"+n+';"':q='style="color:'+n+';"':""!=q&&(q+='"'),""==f||""==g||""==m)return i=a.trim(b.docIds),j=b.displayObj,v=i.split(","),""!=i&&(a.ajax({type:"get",url:e,jsonp:"cascallback",jsonpCallback:"cas_call",dataType:"jsonp",timeout:3e3,data:"pid="+f+"&sid="+g+"&dids="+i,success:function(b){"200"==b.status&&a.each(b.data,function(a,b){b.islike?j.eq(a).html('<div class="cas_like_btn" title="'+s+'" style="cursor:pointer;"><i class="cas_like_icon-prise_add" '+q+' data-did="'+v[a]+'"></i><i class="cas_like_number" '+r+">"+b.like_num+"</i></div>"):j.eq(a).html('<div class="cas_like_btn" title="'+t+'" style="cursor:pointer;"><i class="cas_like_icon-prise_minus" '+q+' data-did="'+v[a]+'"></i><i class="cas_like_number" '+r+">"+b.like_num+"</i></div>")})}}),j.on("click","div.cas_like_btn",function(){var b=a(this),d=a(this).find("i:first"),e=a(this).find("i:last"),h=!0;"cas_like_icon-prise_add"!=d.attr("class")&&(h=!1),h?a.ajax({type:"get",url:k,jsonp:"cascallback",jsonpCallback:"cas_call",dataType:"jsonp",timeout:3e3,data:"pid="+f+"&sid="+g+"&did="+d.data("did"),success:function(a){"200"==a.status&&("vote"==c?(d.removeClass("cas_like_animate"),d.removeClass("cas_like_icon-prise_add").addClass("cas_like_icon-prise_minus"),e.html(a.data),b.attr("title",t)):(d.addClass("cas_like_animate"),setTimeout(function(){d.removeClass("cas_like_animate"),d.removeClass("cas_like_icon-prise_add").addClass("cas_like_icon-prise_minus"),e.html(a.data),b.attr("title",t)},1e3)))}}):u&&a.ajax({type:"get",url:l,jsonp:"cascallback",dataType:"jsonp",jsonpCallback:"cas_call",timeout:3e3,data:"pid="+f+"&sid="+g+"&did="+d.data("did"),success:function(a){"200"==a.status&&(d.addClass("cas_like_animate"),setTimeout(function(){d.removeClass("cas_like_animate"),d.removeClass("cas_like_icon-prise_minus").addClass("cas_like_icon-prise_add"),e.html(a.data),b.attr("title",s)},1e3))}})})),a(this);a.ajax({type:"get",url:e,jsonp:"cascallback",jsonpCallback:"cas_call",dataType:"jsonp",timeout:3e3,data:"pid="+f+"&sid="+g+"&did="+m,success:function(a){"200"==a.status&&d.html('<div class="cas_like_btn" title="'+s+'" style="cursor:pointer;"><i class="cas_like_icon-prise_add" '+q+'></i><i class="cas_like_number" '+r+">"+a.data+"</i></div>"),"201"==a.status&&d.html('<div class="cas_like_btn" title="'+t+'" style="cursor:pointer;"><i class="cas_like_icon-prise_minus" '+q+'></i><i class="cas_like_number" '+r+">"+a.data+"</i></div>")}}),d.on("click","div.cas_like_btn",function(){var b=a(this),d=a(this).find("i:first"),e=a(this).find("i:last"),h=!0;"cas_like_icon-prise_add"!=d.attr("class")&&(h=!1),h?a.ajax({type:"get",url:k,jsonp:"cascallback",jsonpCallback:"cas_call",dataType:"jsonp",timeout:3e3,data:"pid="+f+"&sid="+g+"&did="+m,success:function(a){"200"==a.status&&("vote"==c?(d.removeClass("cas_like_animate"),d.removeClass("cas_like_icon-prise_add").addClass("cas_like_icon-prise_minus"),e.html(a.data),b.attr("title",t)):(d.addClass("cas_like_animate"),setTimeout(function(){d.removeClass("cas_like_animate"),d.removeClass("cas_like_icon-prise_add").addClass("cas_like_icon-prise_minus"),e.html(a.data),b.attr("title",t)},1e3)))}}):u&&a.ajax({type:"get",url:l,jsonp:"cascallback",dataType:"jsonp",jsonpCallback:"cas_call",timeout:3e3,data:"pid="+f+"&sid="+g+"&did="+m,success:function(a){"200"==a.status&&(d.addClass("cas_like_animate"),setTimeout(function(){d.removeClass("cas_like_animate"),d.removeClass("cas_like_icon-prise_minus").addClass("cas_like_icon-prise_add"),e.html(a.data),b.attr("title",s)},1e3))}})})}return d}})}(jQuery);